# Collection Scripts

Scripts for generating stack manifests and assembling curated collections of agents, instructions, and prompts into a single folder.

## Scripts

| Script | Description |
| --- | --- |
| `generate-stack.py` | Scans the repository directories (`agents/`, `instructions/`, `prompts/`) and generates `stack.json` with all files and their frontmatter descriptions. |
| `generate-github-base.py` | Reads a `stack-<source>.json` manifest and copies every referenced file into a destination folder, preserving the original directory structure. |

## Prerequisites

- **Python 3.10+**
- No external dependencies — both scripts use only the Python standard library.

## generate-github-base.py

Copies files listed in a stack JSON manifest into a target folder (default: `github-base/`), preserving relative paths. This is useful for assembling a curated subset of agents, instructions, and prompts into a self-contained directory that can be dropped into any repository's `.github/` folder.

### Usage

Run from the **repository root**:

```bash
python scripts/collection/generate-github-base.py --source <stack-id> [--dest <folder>]
```

### Arguments

| Argument | Required | Default | Description |
| --- | --- | --- | --- |
| `--source` | Yes | — | Stack identifier. The script loads `stack-<source>.json` from `scripts/collection/`. |
| `--dest` | No | `github-base` | Destination base folder relative to the repository root. |

### Available Stacks

| Stack ID | File | Description |
| --- | --- | --- |
| `java` | `stack-java.json` | Java-focused agents, instructions, and prompts. |
| `python` | `stack-python.json` | Python-focused agents, instructions, and prompts. |

> **Tip:** Create your own stack by adding a `stack-<name>.json` file following the same format (see [Stack JSON Format](#stack-json-format) below).

### Examples

**Copy Java stack into `github-base/`:**

```bash
python scripts/collection/generate-github-base.py --source java
```

**Copy Python stack into a custom folder:**

```bash
python scripts/collection/generate-github-base.py --source python --dest my-copilot-setup
```

### What It Does

1. Reads `scripts/collection/stack-<source>.json`.
2. Extracts every `path` entry from the JSON.
3. Copies each file from the repository into `<dest>/<original-path>`, creating intermediate directories as needed.
4. Prints the full path of each copied file to stdout.

### Output Structure

After running with `--source java`, the destination folder will look like:

```
github-base/
├── agents/
│   ├── api-architect.agent.md
│   ├── java-mcp-expert.agent.md
│   └── ...
├── instructions/
│   ├── java.instructions.md
│   └── ...
└── prompts/
    ├── create-spring-boot-java-project.prompt.md
    └── ...
```

> The `github-base/` folder is listed in `.gitignore` and will not be committed.

## generate-stack.py

Scans `agents/`, `instructions/`, and `prompts/` directories and produces `stack.json` with every file, its type, and the `description` extracted from YAML frontmatter.

### Usage

```bash
python scripts/collection/generate-stack.py
```

No arguments required. The output is written to `scripts/collection/stack.json`.

## Stack JSON Format

Each stack file follows this structure:

```json
{
    "files": [
        {
            "type": "agents",
            "path": "agents\\my-agent.agent.md",
            "description": "Description from frontmatter"
        },
        {
            "type": "instructions",
            "path": "instructions\\my-rules.instructions.md",
            "description": "Description from frontmatter"
        },
        {
            "type": "prompts",
            "path": "prompts\\my-prompt.prompt.md",
            "description": "Description from frontmatter"
        }
    ]
}
```

| Field | Description |
| --- | --- |
| `type` | Category: `agents`, `instructions`, or `prompts`. |
| `path` | Relative path from the repository root (backslash-separated on Windows). |
| `description` | Value of the `description:` frontmatter field. Empty string if absent. |

## Creating a Custom Stack

1. Start from the full `stack.json` generated by `generate-stack.py`.
2. Filter or cherry-pick the entries you need.
3. Save the result as `stack-<name>.json` in this folder.
4. Run `generate-github-base.py --source <name>` to assemble the files.
